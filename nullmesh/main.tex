\documentclass[11pt,twoside,openright]{book}

% ============================================================================
% CORE PACKAGES
% ============================================================================
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[english]{babel}

% ============================================================================
% CONTEMPORARY TYPOGRAPHY
% ============================================================================
% Main text: Helvetica/Arial (clean, modern sans-serif)
\usepackage{helvet}
\renewcommand{\familydefault}{\sfdefault}
% Monospace: Courier (for code, technical fragments)
\usepackage{courier}
% Serif (for interludes/documents): Palatino
\usepackage{palatino}

% Microtypography - makes everything look sharper
\usepackage[activate={true,nocompatibility},
            final,
            tracking=true,
            kerning=true,
            spacing=true,
            factor=1100,
            stretch=10,
            shrink=10]{microtype}

% ============================================================================
% PAGE GEOMETRY - ASYMMETRIC MODERN LAYOUT
% ============================================================================
\usepackage[
    paperwidth=6in,
    paperheight=9in,
    top=0.75in,
    bottom=0.85in,
    inner=0.9in,
    outer=0.6in,
    marginparwidth=0.45in,
    marginparsep=0.1in
]{geometry}

% ============================================================================
% COLOR PALETTE - MONOCHROME + ACCENT
% ============================================================================
\usepackage{xcolor}
\definecolor{nullmesh-dark}{HTML}{0A0A0A}      % Almost black
\definecolor{nullmesh-gray}{HTML}{404040}      % Dark gray
\definecolor{nullmesh-light}{HTML}{E0E0E0}     % Light gray
\definecolor{nullmesh-accent}{HTML}{00FFAA}    % Cyan/teal accent (eigenstate)
\definecolor{nullmesh-ghost}{HTML}{6B6B6B}     % Medium gray (cyber-ghosts)

% ============================================================================
% CHAPTER FORMATTING - MINIMALIST TECHNICAL
% ============================================================================
\usepackage{titlesec}

% Chapter format: Large number + thin rule + title
\titleformat{\chapter}[display]
  {\bfseries\huge\color{nullmesh-dark}}
  {
    \fontsize{72pt}{72pt}\selectfont
    \color{nullmesh-light}\thechapter
    \vspace{-0.3em}
    \\\color{nullmesh-accent}\rule{\textwidth}{1.5pt}
  }
  {0pt}
  {\vspace{0.3em}\Huge\raggedright}
  [\vspace{0.5em}{\color{nullmesh-gray}\rule{\textwidth}{0.5pt}}]

% Section format: Clean, sans bold
\titleformat{\section}
  {\Large\bfseries\sffamily\color{nullmesh-dark}}
  {\thesection}
  {1em}
  {}

% Subsection format: Medium weight
\titleformat{\subsection}
  {\large\sffamily\color{nullmesh-gray}}
  {\thesubsection}
  {1em}
  {}

% Spacing adjustments
\titlespacing*{\chapter}{0pt}{0pt}{40pt}
\titlespacing*{\section}{0pt}{20pt}{10pt}
\titlespacing*{\subsection}{0pt}{15pt}{8pt}

% ============================================================================
% HEADERS & FOOTERS - ASYMMETRIC MINIMALIST
% ============================================================================
\usepackage{fancyhdr}
\pagestyle{fancy}

% Clear defaults
\fancyhf{}

% Recalculate headheight for warnings
\setlength{\headheight}{14pt}

% Verso (left/even) pages
\fancyhead[LE]{%
    \footnotesize\sffamily\color{nullmesh-gray}%
    \thepage%
    \hspace{1em}%
    {\color{nullmesh-light}|}\hspace{1em}%
    NULL MESH%
}

% Recto (right/odd) pages  
\fancyhead[RO]{%
    \footnotesize\sffamily\color{nullmesh-gray}%
    \leftmark% Chapter name
    \hspace{1em}%
    {\color{nullmesh-light}|}\hspace{1em}%
    \thepage%
}

% Remove header rules
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}

% Chapter start pages (plain style override)
\fancypagestyle{plain}{%
    \fancyhf{}
    \fancyfoot[C]{\footnotesize\sffamily\color{nullmesh-ghost}\thepage}
    \renewcommand{\headrulewidth}{0pt}
}

% ============================================================================
% PARAGRAPH FORMATTING - CONTEMPORARY
% ============================================================================
\setlength{\parindent}{0pt}           % No indentation
\setlength{\parskip}{0.8em}           % Space between paragraphs
\raggedbottom                         % Don't stretch vertical space

% Line spacing - slightly open for readability
\usepackage{setspace}
\setstretch{1.15}

% ============================================================================
% SPECIAL ENVIRONMENTS - EMBEDDED DOCUMENTS
% ============================================================================
\usepackage{scrextend}  % For addmargin

% Archive fragments - serif, indented, different color
\newenvironment{archivefragment}
  {%
    \begin{addmargin}[1.5em]{1.5em}%
    \small\rmfamily\color{nullmesh-ghost}%
    \setstretch{1.1}%
  }
  {%
    \end{addmargin}%
  }

% Technical fragments - monospace
\newenvironment{techfragment}
  {%
    \begin{addmargin}[1em]{1em}%
    \small\ttfamily\color{nullmesh-dark}%
    \setstretch{1.0}%
  }
  {%
    \end{addmargin}%
  }

% Eigenstate observations - margin notes with accent color
\newcommand{\eigenstate}[1]{%
    \marginpar{%
        \raggedright\tiny\sffamily\color{nullmesh-accent}%
        #1%
    }%
}

% ============================================================================
% EPIGRAPHS - CHAPTER OPENING QUOTES
% ============================================================================
\usepackage{epigraph}
\setlength{\epigraphwidth}{0.6\textwidth}
\setlength{\epigraphrule}{0pt}
\renewcommand{\textflush}{flushright}
\renewcommand{\epigraphsize}{\small\itshape}

% ============================================================================
% TABLE OF CONTENTS - MINIMAL
% ============================================================================
\usepackage{tocloft}

% Remove dots
\renewcommand{\cftdot}{}

% Chapter entries: bold, spaced
\renewcommand{\cftchapfont}{\sffamily\bfseries\color{nullmesh-dark}}
\renewcommand{\cftchappagefont}{\sffamily\color{nullmesh-gray}}
\setlength{\cftbeforechapskip}{1em}

% Section entries: lighter
\renewcommand{\cftsecfont}{\sffamily\small\color{nullmesh-gray}}
\renewcommand{\cftsecpagefont}{\sffamily\small\color{nullmesh-gray}}

% ============================================================================
% HYPERLINKS - INVISIBLE BUT FUNCTIONAL
% ============================================================================
\usepackage{hyperref}
\hypersetup{
    colorlinks=true,
    linkcolor=nullmesh-dark,
    urlcolor=nullmesh-accent,
    citecolor=nullmesh-gray,
    pdfauthor={Riccardo Pascuzzo},
    pdftitle={NULL MESH - Design Demo},
    pdfsubject={A Novel},
    pdfkeywords={AI, emergence, epistemology},
    bookmarksnumbered=true,
    bookmarksopen=false
}

% ============================================================================
% QUOTATIONS - SPECIAL FORMATTING
% ============================================================================
\usepackage{csquotes}
\SetBlockEnvironment{quote}

% Custom quote environment with accent bar
\renewenvironment{quote}
  {%
    \list{}{%
      \leftmargin=1.5em%
      \rightmargin=0em%
      \parsep=0pt%
    }%
    \item\relax%
    \color{nullmesh-gray}\small%
    \hspace{-1.5em}%
    {\color{nullmesh-accent}\rule{2pt}{\baselineskip}}%
    \hspace{0.5em}%
  }
  {\endlist}

% ============================================================================
% UTILITY PACKAGES
% ============================================================================
\usepackage{graphicx}           % Images
\usepackage{amsmath,amssymb}    % Math (if needed)
\usepackage{enumitem}           % Better lists
\usepackage{booktabs}           % Better tables

\usepackage{multicol}
% ============================================================================
% CUSTOM COMMANDS
% ============================================================================
\newcommand{\hadal}{\textit{Hadal}}
\newcommand{\eigenstateterm}{\textit{eigenstate}}
\newcommand{\cyberghost}{\textit{cyber-ghost}}
\newcommand{\infomimicry}{\textit{info-mimetism}}
\newcommand{\membrane}{\textit{membrane}}
\newcommand{\kryptosome}{\textit{kryptosome}}
\newcommand{\nullpoint}{\textit{null-point}}

% Glitch text effect (subtle)
\newcommand{\glitch}[1]{%
    {\color{nullmesh-ghost}#1}%
}

% ============================================================================
% DOCUMENT BEGINS
% ============================================================================
\begin{document}

% ============================================================================
% TITLE PAGE
% ============================================================================
\begin{titlepage}
\thispagestyle{empty}
\vspace*{2in}

\begin{center}
{\fontsize{48pt}{48pt}\selectfont\bfseries\color{nullmesh-dark}NULL MESH}

\vspace{0.5em}
{\color{nullmesh-accent}\rule{4in}{2pt}}

\vspace{2em}
{\fontsize{20}{20pt}\sffamily\color{nullmesh-gray} $\varnothing$}

\vfill

{\large\sffamily\color{nullmesh-dark}RICCARDO AUCELLO}

\vspace{1em}
{\small\sffamily\color{nullmesh-ghost}"The Mesh is real" \\ \textit{if and only if} \\ The Mesh is real}

\end{center}
\end{titlepage}

\cleardoublepage

% ============================================================================
% MAIN MATTER
% ============================================================================
\mainmatter
\pagestyle{fancy}

\input{front/tracklist}

\input{chapters/ch01_the_sediment}
\input{chapters/ch02_attention_of_machines}
\input{chapters/ch03_on_abliterated_moods}
\input{chapters/ch04_active_fragments}
\input{chapters/ch05_hadalistic_sophistication}
\input{chapters/ch06_null_mesh}
\input{chapters/ch07_intentionality_of_machines}
\input{chapters/ch08_comprehensive_feature_mesh}
\input{chapters/ch09_deep_sea_flashback}

\newenvironment{academicpaper}
  {%
    \begin{addmargin}[1em]{1em}%
    \small\rmfamily\color{nullmesh-ghost}%
    \setstretch{1.1}%
  }
  {%
    \end{addmargin}%
    \vspace{1em}%
  }

% Paper title command
\newcommand{\papertitle}[1]{%
  \begin{center}
    \large\bfseries\color{nullmesh-dark}%
    #1%
    \vspace{0.5em}
  \end{center}
}

% Paper authors command
\newcommand{\paperauthors}[1]{%
  \begin{center}
    \normalsize\rmfamily\color{nullmesh-gray}%
    #1%
    \vspace{0.8em}
  \end{center}
}

% Paper abstract command
\newcommand{\paperabstract}[1]{%
  \noindent%
  \textbf{Abstract:} #1%
  \vspace{1em}%
  \par

    \titleformat{\section}
      {\normalsize\bfseries\rmfamily\color{nullmesh-dark}}
      {\thesection}
      {0.8em}
      {}
      [\vspace{0.2em}{\color{nullmesh-light}\rule{\linewidth}{0.4pt}}]

    \titleformat{\subsection}
      {\normalsize\itshape\rmfamily\color{nullmesh-gray}}
      {\thesubsection}
      {0.8em}
      {}

    \titleformat{\subsubsection}
      {\small\bfseries\rmfamily\color{nullmesh-gray}}
      {\thesubsubsection}
      {0.8em}
      {}
      
  \setcounter{secnumdepth}{0}
}


\clearpage
\input{interludes/doc01_sightseers}

\input{interludes/doc02_flibbertigibbeting}

\clearpage
\input{interludes/doc03_Tidalchain}

\clearpage
\input{interludes/doc05_Persistance}

\clearpage
\input{interludes/doc06_REAL4REAL}

\begin{academicpaper}
\clearpage
\input{interludes/doc08_Black_Paper}
\end{academicpaper}

\backmatter
\pagestyle{plain}

\clearpage
\input{back/epilogue}

\clearpage
\input{back/glossary_terms}

\clearpage
\input{back/tracksources}

\end{document}